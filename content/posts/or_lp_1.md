+++
title = "线性规划——单纯形法"
date = "2024-10-28"
updated = "2024-10-28"

[taxonomies]
tags=["课程「运筹学」"]
+++

# 线性规划模型

我们在中学时候就接触过低维的线性规划问题, 例如

$$
\begin{aligned}
\max \quad & x + y \newline
\text{s.t.} \quad & x + 2y \le 3 \newline
& 4x + 3y \le 7
\end{aligned}
$$

其中 $x+y$ 称为**目标函数**, 后面的两个不等式称为**约束**. 当时我们的解决方法是, 将不等式约束看成是平面 $\mathbb{R}^2$ 上的一个区域, 然后移动直线 $z=x+y$, 在保持直线和区域有交点的情况下, 使得截距 $z$ 最大. 通过这种方法, 轻易就能看出上面这个问题的**最优解**为 $(x,y)=(1,1)$, **最优目标值**为 $z=2$. 

但是当变量的个数变得更多, 解空间的维数变得更高的时候, 我们就们没有办法再画图去观察了. 这时候我们需要寻求一种对于任意规模的线性规划问题都*普适*的, *机械化*的方法. 

为了达到这个目标, 首先需要将所有的线性规划用一个统一的形式表示. 即**标准型**: 

## 标准型

以下形式的线性规划问题, 称为线性规划的标准型:

$$
\begin{aligned}
\max \quad & \mathbf{c^\top} \mathbf{x} \newline
\text{s.t.} \quad & \mathbf{A}\mathbf{x} = \mathbf{b} \newline
& \mathbf{x} \ge \mathbf{0}
\end{aligned}
$$

这里的 $\mathbf{x}, \mathbf{c}$ 是 $n$ 维向量, 即解空间是 $n$ 维的. $\mathbf{A}$ 是 $m \times n$ 满秩矩阵 ($m<n$), $\mathbf{b}$ 是 $m$ 维向量, $\mathbf{A}\mathbf{x} = \mathbf{b}$ 就是关于 $\mathbf{x}$ 的 $m$ 个独立的线性方程(要求 $m<n$, 是因为若 $m\ge n$, 则方程组可以直接解出来或者无解, 从而没有必要讨论). $\mathbf{x} \ge \mathbf{0}$ 的意思是 $\mathbf{x}$ 的所有分量都不小于 $0$.

乍一看可能不太好理解, 为什么标准型中的约束有等式形式的呢? 我们在中学时接触过的线性规划(例如上面给的例子), 不都是不等式约束吗? 其实通过一些操作, 我们可以强行把这些不等式约束变成等式约束, 并且引入所有变量非负的约束, 从而变成标准型. 

## 将任意线性规划问题化为标准型

以上面的例子为例. 首先, $x$ 和 $y$ 并没有非负的限制, 这不符合标准型的要求. 但是我们知道, 任何一个实数都可以拆成两个非负实数的差, 所以只要将 $x$ 和 $y$ 分别拆成 $x=x_1-x_2, y=x_3 - x_4$ 即可:

$$
\begin{aligned}
\max \quad & x_1 - x_2 + x_3 - x_4 \newline
\text{s.t.} \quad & x_1-x_2 + 2x_3 - 2x_4 \le 3 \newline
& 4x_1 - 4x_2 + 3x_3 - 3x_4 \le 7 \newline
& x_i \ge 0, i=1,2,3,4
\end{aligned}
$$

接下来还差一步, 我们要将除了非负约束外的不等式约束都变成等式约束. 这其实也很简单. 我们观察第一个不等式, 既然 $x_1-x_2 + 2x_3 - 2x_4 \le 3$, 那么 $x_1-x_2 + 2x_3 - 2x_4$ 加上一个正数不就等于 $3$ 吗? 于是我们引入一个变量 $x_5$: 

$$
\begin{aligned}
& x_1-x_2 + 2x_3 - 2x_4 + x_5 = 3 \newline
& x_5 \ge 0
\end{aligned}
$$

对于第二个不等式, 也是一样的操作. 于是原问题就变成了下面的标准型: 

$$
\begin{aligned}
\max \quad & x_1 - x_2 + x_3 - x_4 \newline
\text{s.t.} \quad & x_1-x_2 + 2x_3 - 2x_4 + x_5 = 3 \newline
& 4x_1 - 4x_2 + 3x_3 - 3x_4 + x_6 = 7 \newline
& x_i \ge 0, i=1,2,\dots,6
\end{aligned}
$$

虽然问题的变量个数从 $2$ 个增加到了 $6$ 个, 但是不用怕. 只要化成了标准型, 就可以使用**单纯形法**机械地求出最优解. 

# 可行域和顶点

在介绍单纯形法之前, 首先要对标准型的可行域和顶点有所理解. **可行域**就是指解空间 $\mathbb{R}^n$ 中, 满足约束的那些点的集合. 这些满足约束的点就称为**可行解**. 

## 可行域是凸集

标准型中的 $m$ 个(互相独立的)等式约束, 首先在解空间 $\mathbb{R}^n$ 中确定了一个 $n-m$ 维的*线性子空间*. 只有在这个子空间中的点, 才有可能是可行解. 例如, 假如问题的解是 $3$ 维的, 如果我们有 $1$ 个等式约束, 那么它就确定了一个平面($2$ 维子空间), 只有这个平面上的点才有可能是可行解; 如果有 $2$ 个等式约束, 那么它们就确定了一条直线($1$ 维子空间), 只有这条直线上的点才有可能是可行解. 

接下来, 所有非负约束把这个 $n-m$ 维的线性子空间截断, 最终使得可行域是一个 $n-m$ 维的*凸多面体*(也有可能是一个无界的凸集, 但是不影响下面得出的结论). 

## 最优解是顶点

想象 $3$ 维解空间中的等式约束 $x_1+x_2+x_3=1$, 它所确定的平面被非负约束 $x_1 \ge 0, x_2 \ge 0, x_3 \ge 0$ 截断成了顶点为 $(1,0,0), (0,1,0), (0,0,1)$ 的等边三角形 $\Delta$. 而我们的目标函数 $z=ax_1+bx_2+cx_3$ 是一个平面. 当我们移动这个平面, 使得它与三角形 $\Delta$ 有相交区域时, $z$ 就是可能取到的目标函数值. 什么时候目标函数值能最大呢? 如果这个平面与三角形 $\Delta$ 不平行的话, 不难想象, 必然是两者交于三角形 $\Delta$ 的顶点的时候, 在此顶点处目标函数值最大. 于是我们有下面的定理: 

{{ note(header="定理", body="线性规划问题若有有界最优解, 则必有一个最优解是可行域的顶点.") }}

再回到一般的情况, 我们若想在 $n-m$ 维的凸可行域中找到使得目标函数值最大的点, 必然只能在可行域的顶点中去寻找. 那么要怎么获得这些顶点呢? 我们再回到代数的视角, 现在有 $m$ 个等式, 要确定一个 $n$ 维的点, 所以我们还需要 $n-m$ 个等式. 既然是顶点, 那么这 $n-m$ 个等式, 当然就是在 $n$ 个非负变量中, 任意取 $n-m$ 个为 $0$. 这样的取法共有 $\mathrm{C}_{n}^{n-m}$ 种, 对于这么多可能的取法, 单纯形法提供了一种较为系统且完备的遍历方法.

# 单纯形法

仍然考虑以下形式的标准型: 


$$
\begin{aligned}
\max \quad & \mathbf{c^\top} \mathbf{x} \newline
\text{s.t.} \quad & \mathbf{A}\mathbf{x} = \mathbf{b} \newline
& \mathbf{x} \ge \mathbf{0} \newline
\end{aligned}
$$
$$
(\mathbf{A} \in \mathbb{R}^{m\times n}; \mathbf{x}, \mathbf{c} \in \mathbb{R}^n;\mathbf{b} \in \mathbb{R}^m)
$$

TODO